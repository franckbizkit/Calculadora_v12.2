<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    
    <!-- ConfiguraciÃ³n PWA -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#111827">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="NÃ³mina CGT">
    <link rel="apple-touch-icon" href="icono.png">

    <title>Calculadora NÃ³mina | CGT</title>
    
    <style>
        /* CSS PREMIUM INTEGRADO Y OFFLINE */
        *, *::before, *::after { box-sizing: border-box; }
        
        body { 
            font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif; 
            background-color: #f3f4f6; color: #1f2937; margin: 0; padding-bottom: 6rem; -webkit-tap-highlight-color: transparent;
        }

        .max-w-md { max-width: 28rem; } .mx-auto { margin-left: auto; margin-right: auto; } .w-full { width: 100%; }
        .flex { display: flex; } .flex-col { flex-direction: column; } .items-center { align-items: center; } .justify-center { justify-content: center; } .justify-between { justify-content: space-between; }
        .grid { display: grid; } .grid-cols-2 { grid-template-columns: repeat(2, minmax(0, 1fr)); } .grid-cols-3 { grid-template-columns: repeat(3, minmax(0, 1fr)); } .grid-cols-4 { grid-template-columns: repeat(4, minmax(0, 1fr)); }
        
        .gap-1 { gap: 0.25rem; } .gap-2 { gap: 0.5rem; } .gap-3 { gap: 0.75rem; } .gap-4 { gap: 1rem; } .gap-x-4 { column-gap: 1rem; } .gap-y-6 { row-gap: 1.5rem; }
        .mt-1 { margin-top: 0.25rem; } .mt-2 { margin-top: 0.5rem; } .mt-3 { margin-top: 0.75rem; } .mt-4 { margin-top: 1rem; } .mt-5 { margin-top: 1.25rem; } .mt-6 { margin-top: 1.5rem; } .mt-8 { margin-top: 2rem; } .mt-10 { margin-top: 2.5rem; }
        .mb-1 { margin-bottom: 0.25rem; } .mb-2 { margin-bottom: 0.5rem; } .mb-3 { margin-bottom: 0.75rem; } .mb-4 { margin-bottom: 1rem; } .mb-5 { margin-bottom: 1.25rem; } .mb-6 { margin-bottom: 1.5rem; } .mb-8 { margin-bottom: 2rem; }
        .my-3 { margin-top: 0.75rem; margin-bottom: 0.75rem; } .ml-2 { margin-left: 0.5rem; } .mr-2 { margin-right: 0.5rem; }
        
        .pt-3 { padding-top: 0.75rem; } .pt-4 { padding-top: 1rem; } .pt-5 { padding-top: 1.25rem; } .pt-6 { padding-top: 1.5rem; } .pb-2 { padding-bottom: 0.5rem; } .pb-4 { padding-bottom: 1rem; }
        .px-3 { padding-left: 0.75rem; padding-right: 0.75rem; } .px-4 { padding-left: 1rem; padding-right: 1rem; } .px-6 { padding-left: 1.5rem; padding-right: 1.5rem; } .py-1\.5 { padding-top: 0.375rem; padding-bottom: 0.375rem; }
        .p-4 { padding: 1rem; } .p-6 { padding: 1.5rem; }
        
        .w-4 { width: 1rem; } .h-4 { height: 1rem; } .w-5 { width: 1.25rem; } .h-5 { height: 1.25rem; }
        
        .\!bg-slate-50 { background-color: #f8fafc !important; } .\!py-4 { padding-top: 1rem !important; padding-bottom: 1rem !important; } .\!px-3 { padding-left: 0.75rem !important; padding-right: 0.75rem !important; }
        .\!w-12 { width: 3rem !important; } .\!w-16 { width: 4rem !important; } .\!w-20 { width: 5rem !important; } .\!w-24 { width: 6rem !important; } .\!w-32 { width: 8rem !important; }
        .\!p-1 { padding: 0.25rem !important; } .\!p-1\.5 { padding: 0.375rem !important; }
        .\!text-xs { font-size: 0.75rem !important; line-height: 1rem !important; } .\!text-sm { font-size: 0.875rem !important; line-height: 1.25rem !important; }

        .text-center { text-align: center; } .text-right { text-align: right; } .uppercase { text-transform: uppercase; }
        
        .text-\[10px\] { font-size: 10px; } .text-\[11px\] { font-size: 11px; } .text-xs { font-size: 0.75rem; line-height: 1rem; } .text-sm { font-size: 0.875rem; line-height: 1.25rem; }
        .text-base { font-size: 1rem; line-height: 1.5rem; } .text-lg { font-size: 1.125rem; line-height: 1.75rem; } .text-xl { font-size: 1.25rem; line-height: 1.75rem; } .text-3xl { font-size: 1.875rem; line-height: 2.25rem; } .text-4xl { font-size: 2.25rem; line-height: 2.5rem; }
        
        .font-medium { font-weight: 500; } .font-semibold { font-weight: 600; } .font-bold { font-weight: 700; } .font-black { font-weight: 900; }
        .tracking-tight { letter-spacing: -0.025em; } .tracking-wide { letter-spacing: 0.025em; } .tracking-wider { letter-spacing: 0.05em; } .tracking-widest { letter-spacing: 0.1em; }
        .leading-none { line-height: 1; } .leading-tight { line-height: 1.25; } .leading-relaxed { line-height: 1.625; }
        
        .text-white { color: #ffffff; }
        .text-slate-400 { color: #94a3b8; } .text-slate-500 { color: #64748b; } .text-slate-600 { color: #475569; } .text-slate-700 { color: #334155; } .text-slate-800 { color: #1e293b; } .text-slate-900 { color: #0f172a; }
        .text-red-400 { color: #f87171; } .text-red-500 { color: #ef4444; } .text-red-600 { color: #dc2626; }
        .text-emerald-600 { color: #059669; } .text-emerald-800 { color: #065f46; }
        .text-blue-500 { color: #3b82f6; } .text-blue-600 { color: #2563eb; }
        .text-amber-600 { color: #d97706; } .text-orange-500 { color: #f97316; } .text-indigo-500 { color: #6366f1; } .text-indigo-700 { color: #4338ca; } .text-purple-600 { color: #9333ea; }
        
        .bg-white { background-color: #ffffff; } .bg-slate-50 { background-color: #f8fafc; } .bg-slate-100 { background-color: #f1f5f9; } .bg-red-50 { background-color: #fef2f2; } .bg-emerald-50 { background-color: #ecfdf5; }
        
        .border { border-width: 1px; border-style: solid; } .border-t { border-top-width: 1px; border-top-style: solid; } .border-t-2 { border-top-width: 2px; border-top-style: solid; } .border-b { border-bottom-width: 1px; border-bottom-style: solid; }
        .border-slate-100 { border-color: #f1f5f9; } .border-slate-200 { border-color: #e2e8f0; } .border-red-100 { border-color: #fee2e2; } .border-emerald-100 { border-color: #d1fae5; }
        .rounded-lg { border-radius: 0.5rem; } .rounded-xl { border-radius: 0.75rem; } .rounded-2xl { border-radius: 1rem; }
        
        .shadow-inner { box-shadow: inset 0 2px 4px 0 rgba(0, 0, 0, 0.05); } .drop-shadow-xl { filter: drop-shadow(0 20px 13px rgba(0, 0, 0, 0.03)) drop-shadow(0 8px 5px rgba(0, 0, 0, 0.08)); }
        
        .hidden { display: none !important; } .block { display: block; } .inline-block { display: inline-block; }
        .relative { position: relative; } .z-10 { z-index: 10; }
        .transition-colors { transition-property: color, background-color, border-color; transition-duration: 150ms; }
        .outline-none { outline: 2px solid transparent; outline-offset: 2px; } .cursor-pointer { cursor: pointer; } .hover\:text-red-600:hover { color: #dc2626; }

        /* ESTILOS ESPECÃFICOS DE LA APP */
        .app-header {
            background: #111827; border-bottom-left-radius: 32px; border-bottom-right-radius: 32px;
            padding: 3rem 1.5rem 2rem 1.5rem; position: relative; box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1); overflow: hidden;
        }
        .app-header::after { content: ''; position: absolute; bottom: 0; left: 0; right: 0; height: 4px; background: linear-gradient(90deg, #dc2626, #ef4444); }

        .app-card { background: #ffffff; border-radius: 24px; box-shadow: 0 4px 20px -2px rgba(0, 0, 0, 0.05); padding: 1.5rem; margin-bottom: 1.5rem; }

        .section-badge { 
            font-size: 0.75rem; font-weight: 800; color: #dc2626; background: #fee2e2;
            text-transform: uppercase; letter-spacing: 0.1em; padding: 6px 14px; 
            border-radius: 9999px; display: inline-flex; align-items: center; justify-content: center; margin-bottom: 1.5rem;
        }

        .input-base {
            background: #f8fafc; border: 2px solid transparent; border-radius: 12px;
            color: #0f172a; font-weight: 700; outline: none; transition: all 0.2s; width: 100%; text-align: center;
        }
        .input-base:focus { background: #ffffff; border-color: #3b82f6; box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.1); }
        .input-var { padding: 0.5rem; font-size: 1.1rem; }
        .input-personal { padding: 0.75rem; text-align: right; font-size: 1.1rem; }
        .cfg-input { padding: 0.4rem; text-align: right; font-size: 0.95rem; border: 1px solid #e2e8f0; }

        .segmented-control { background: #f1f5f9; padding: 4px; border-radius: 16px; display: flex; gap: 4px; }
        .btn-cat { flex: 1; padding: 0.75rem 0; border-radius: 12px; font-weight: 700; color: #64748b; transition: all 0.2s ease; border: none; background: transparent; font-size: 1rem; }
        .cat-activa { background: #ffffff; color: #dc2626; box-shadow: 0 2px 8px rgba(0,0,0,0.08); }

        .btn-toggle input { display: none; }
        .btn-toggle span {
            display: flex; align-items: center; justify-content: center; width: 100%; padding: 0.85rem; border-radius: 14px;
            background: #f8fafc; color: #475569; font-weight: 700; text-align: center; border: 2px solid transparent; transition: all 0.2s ease; font-size: 0.85rem; cursor: pointer;
        }
        .btn-toggle input:checked + span { background: #fef2f2; color: #dc2626; border-color: #fecaca; box-shadow: 0 4px 12px rgba(220, 38, 38, 0.1); }

        .switch-ios { position: relative; display: inline-block; width: 50px; height: 28px; }
        .switch-ios input { opacity: 0; width: 0; height: 0; }
        .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #cbd5e1; border-radius: 34px; transition: .3s; }
        .slider:before { position: absolute; content: ""; height: 24px; width: 24px; left: 2px; bottom: 2px; background-color: white; transition: .3s; border-radius: 50%; box-shadow: 0 2px 4px rgba(0,0,0,0.2); }
        input:checked + .slider { background-color: #22c55e; }
        input:checked + .slider:before { transform: translateX(22px); }

        .btn-calcular { 
            background: #dc2626; color: white; font-weight: 800; padding: 1.25rem; width: 100%; 
            font-size: 1.1rem; border-radius: 16px; border: none; cursor: pointer; 
            box-shadow: 0 10px 20px -5px rgba(220, 38, 38, 0.4); transition: all 0.2s ease; display: flex; justify-content: center; align-items: center; gap: 8px;
        }
        .btn-calcular:active { transform: scale(0.97); background: #b91c1c; }

        .btn-download {
            display: flex; align-items: center; justify-content: center; gap: 10px;
            background: #334155; color: white; font-weight: bold; padding: 1rem;
            width: 100%; border-radius: 16px; text-decoration: none; font-size: 0.9rem;
            margin-bottom: 1rem; transition: background 0.2s;
        }
        .btn-download:active { background: #1e293b; }

        #resultado { background: #ffffff; color: #1f2937; padding: 1.5rem; border-radius: 24px; box-shadow: 0 20px 40px -10px rgba(0,0,0,0.1); }
        .inner-box { background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 16px; padding: 1rem; }
        
        input[type=number]::-webkit-inner-spin-button, input[type=number]::-webkit-outer-spin-button { -webkit-appearance: none; margin: 0; }
        details > summary { list-style: none; }
        details > summary::-webkit-details-marker { display: none; }
    </style>
</head>
<body>

<header class="app-header flex flex-col items-center justify-center">
    <svg width="80" height="80" viewBox="0 0 100 100" class="relative z-10 drop-shadow-xl mb-4">
        <rect width="100" height="100" rx="24" fill="white"/>
        <path d="M0 0 L100 100 L100 0 Z" fill="#cc0000"/>
        <path d="M0 100 L100 100 L0 0 Z" fill="#000000"/>
        <text x="50" y="66" font-family="Arial Black" font-weight="900" font-size="26" fill="white" text-anchor="middle">CGT</text>
    </svg>
    <h1 class="text-3xl font-black text-white uppercase tracking-tight text-center leading-tight">Calculadora<br><span class="text-red-500">NÃ³mina</span></h1>
</header>

<main class="max-w-md mx-auto px-4 mt-6">
    
    <!-- ConfiguraciÃ³n Desplegable Completa -->
    <details class="app-card \!bg-slate-50 border border-slate-200 \!py-4 mb-6" id="config-panel">
        <summary class="font-bold text-xs tracking-wider uppercase cursor-pointer text-slate-500 hover:text-red-600 transition-colors outline-none flex justify-between items-center">
            <span class="flex items-center gap-2">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path></svg>
                Configurar Precios Base
            </span>
            <span class="text-lg leading-none">+</span>
        </summary>
        
        <div class="grid grid-cols-2 gap-x-4 gap-y-6 mt-5 text-[11px] text-slate-600 border-t border-slate-200 pt-4">

            <div class="flex-col"><p class="font-bold text-slate-800 uppercase border-b border-slate-200 pb-2 mb-2">Salario Base</p>
                <div class="flex justify-between items-center mb-1"><span class="font-bold">B3</span> <input id="cfg-base-B3" class="input-base cfg-input" value="1932.67" type="number" step="0.01" onchange="guardar()"></div>
                <div class="flex justify-between items-center mb-1"><span class="font-bold">B4</span> <input id="cfg-base-B4" class="input-base cfg-input" value="1932.67" type="number" step="0.01" onchange="guardar()"></div>
                <div class="flex justify-between items-center mb-1"><span class="font-bold">C5</span> <input id="cfg-base-C5" class="input-base cfg-input" value="2125.85" type="number" step="0.01" onchange="guardar()"></div>
                <div class="flex justify-between items-center"><span class="font-bold">C6</span> <input id="cfg-base-C6" class="input-base cfg-input" value="2125.85" type="number" step="0.01" onchange="guardar()"></div>
            </div>
            
            <div class="flex-col"><p class="font-bold text-slate-800 uppercase border-b border-slate-200 pb-2 mb-2">Compl. Nivel</p>
                <div class="flex justify-between items-center mb-1"><span class="font-bold">B3</span> <input id="cfg-nivel-B3" class="input-base cfg-input" value="302.10" type="number" step="0.01" onchange="guardar()"></div>
                <div class="flex justify-between items-center mb-1"><span class="font-bold">B4</span> <input id="cfg-nivel-B4" class="input-base cfg-input" value="588.39" type="number" step="0.01" onchange="guardar()"></div>
                <div class="flex justify-between items-center mb-1"><span class="font-bold">C5</span> <input id="cfg-nivel-C5" class="input-base cfg-input" value="693.03" type="number" step="0.01" onchange="guardar()"></div>
                <div class="flex justify-between items-center"><span class="font-bold">C6</span> <input id="cfg-nivel-C6" class="input-base cfg-input" value="1128.10" type="number" step="0.01" onchange="guardar()"></div>
            </div>
            
            <div class="flex-col"><p class="font-bold text-slate-800 uppercase border-b border-slate-200 pb-2 mb-2">Nocturnidad</p>
                <div class="flex justify-between items-center mb-1"><span class="font-bold">B3</span> <input id="cfg-noc-B3" class="input-base cfg-input" value="29.79" type="number" step="0.01" onchange="guardar()"></div>
                <div class="flex justify-between items-center mb-1"><span class="font-bold">B4</span> <input id="cfg-noc-B4" class="input-base cfg-input" value="33.62" type="number" step="0.01" onchange="guardar()"></div>
                <div class="flex justify-between items-center mb-1"><span class="font-bold">C5</span> <input id="cfg-noc-C5" class="input-base cfg-input" value="37.59" type="number" step="0.01" onchange="guardar()"></div>
                <div class="flex justify-between items-center"><span class="font-bold">C6</span> <input id="cfg-noc-C6" class="input-base cfg-input" value="43.36" type="number" step="0.01" onchange="guardar()"></div>
            </div>
            
            <div class="flex-col"><p class="font-bold text-slate-800 uppercase border-b border-slate-200 pb-2 mb-2">Extras Diurnas</p>
                <div class="flex justify-between items-center mb-1"><span class="font-bold">B3</span> <input id="cfg-exD-B3" class="input-base cfg-input" value="25.51" type="number" step="0.01" onchange="guardar()"></div>
                <div class="flex justify-between items-center mb-1"><span class="font-bold">B4</span> <input id="cfg-exD-B4" class="input-base cfg-input" value="26.86" type="number" step="0.01" onchange="guardar()"></div>
                <div class="flex justify-between items-center mb-1"><span class="font-bold">C5</span> <input id="cfg-exD-C5" class="input-base cfg-input" value="28.10" type="number" step="0.01" onchange="guardar()"></div>
                <div class="flex justify-between items-center"><span class="font-bold">C6</span> <input id="cfg-exD-C6" class="input-base cfg-input" value="28.10" type="number" step="0.01" onchange="guardar()"></div>
            </div>
            
            <div class="flex-col"><p class="font-bold text-slate-800 uppercase border-b border-slate-200 pb-2 mb-2">Extras Nocturnas</p>
                <div class="flex justify-between items-center mb-1"><span class="font-bold">B3</span> <input id="cfg-exN-B3" class="input-base cfg-input" value="35.73" type="number" step="0.01" onchange="guardar()"></div>
                <div class="flex justify-between items-center mb-1"><span class="font-bold">B4</span> <input id="cfg-exN-B4" class="input-base cfg-input" value="37.60" type="number" step="0.01" onchange="guardar()"></div>
                <div class="flex justify-between items-center mb-1"><span class="font-bold">C5</span> <input id="cfg-exN-C5" class="input-base cfg-input" value="39.33" type="number" step="0.01" onchange="guardar()"></div>
                <div class="flex justify-between items-center"><span class="font-bold">C6</span> <input id="cfg-exN-C6" class="input-base cfg-input" value="39.33" type="number" step="0.01" onchange="guardar()"></div>
            </div>
            
            <div class="flex-col"><p class="font-bold text-slate-800 uppercase border-b border-slate-200 pb-2 mb-2">Extras Festivas</p>
                <div class="flex justify-between items-center mb-1"><span class="font-bold">B3</span> <input id="cfg-exF-B3" class="input-base cfg-input" value="38.28" type="number" step="0.01" onchange="guardar()"></div>
                <div class="flex justify-between items-center mb-1"><span class="font-bold">B4</span> <input id="cfg-exF-B4" class="input-base cfg-input" value="40.29" type="number" step="0.01" onchange="guardar()"></div>
                <div class="flex justify-between items-center mb-1"><span class="font-bold">C5</span> <input id="cfg-exF-C5" class="input-base cfg-input" value="42.14" type="number" step="0.01" onchange="guardar()"></div>
                <div class="flex justify-between items-center"><span class="font-bold">C6</span> <input id="cfg-exF-C6" class="input-base cfg-input" value="42.14" type="number" step="0.01" onchange="guardar()"></div>
            </div>
            
            <div class="flex-col"><p class="font-bold text-slate-800 uppercase border-b border-slate-200 pb-2 mb-2">Extras Fest. Noct.</p>
                <div class="flex justify-between items-center mb-1"><span class="font-bold">B3</span> <input id="cfg-exFN-B3" class="input-base cfg-input" value="48.48" type="number" step="0.01" onchange="guardar()"></div>
                <div class="flex justify-between items-center mb-1"><span class="font-bold">B4</span> <input id="cfg-exFN-B4" class="input-base cfg-input" value="51.02" type="number" step="0.01" onchange="guardar()"></div>
                <div class="flex justify-between items-center mb-1"><span class="font-bold">C5</span> <input id="cfg-exFN-C5" class="input-base cfg-input" value="53.37" type="number" step="0.01" onchange="guardar()"></div>
                <div class="flex justify-between items-center"><span class="font-bold">C6</span> <input id="cfg-exFN-C6" class="input-base cfg-input" value="53.37" type="number" step="0.01" onchange="guardar()"></div>
            </div>
            
            <div class="flex-col"><p class="font-bold text-slate-800 uppercase border-b border-slate-200 pb-2 mb-2">4Âº Turno</p>
                <div class="flex justify-between items-center mb-1"><span class="font-bold">SAB 8h</span> <input id="cfg-t-s8" class="input-base cfg-input" value="154.91" type="number" step="0.01" onchange="guardar()"></div>
                <div class="flex justify-between items-center mb-1"><span class="font-bold">SAB 12h</span> <input id="cfg-t-s12" class="input-base cfg-input" value="232.37" type="number" step="0.01" onchange="guardar()"></div>
                <div class="flex justify-between items-center mb-1"><span class="font-bold">DOM 8h</span> <input id="cfg-t-d8" class="input-base cfg-input" value="177.89" type="number" step="0.01" onchange="guardar()"></div>
                <div class="flex justify-between items-center"><span class="font-bold">DOM 12h</span> <input id="cfg-t-d12" class="input-base cfg-input" value="265.50" type="number" step="0.01" onchange="guardar()"></div>
            </div>
            
            <div class="flex-col"><p class="font-bold text-slate-800 uppercase border-b border-slate-200 pb-2 mb-2">Precios Base Pluses</p>
                <div class="flex justify-between items-center mb-1"><span class="font-bold">Arr. B4</span> <input id="cfg-arr-B4" class="input-base cfg-input" value="20.78" type="number" step="0.01" onchange="guardar()"></div>
                <div class="flex justify-between items-center mb-1"><span class="font-bold">Arr. C5</span> <input id="cfg-arr-C5" class="input-base cfg-input" value="22.26" type="number" step="0.01" onchange="guardar()"></div>
                <div class="flex justify-between items-center mb-1"><span class="font-bold">Arr. C6</span> <input id="cfg-arr-C6" class="input-base cfg-input" value="23.24" type="number" step="0.01" onchange="guardar()"></div>
                <div class="flex justify-between items-center mb-1"><span class="font-bold">Adscrip.</span> <input id="cfg-ads" class="input-base cfg-input" value="110.63" type="number" step="0.01" onchange="guardar()"></div>
                <div class="flex justify-between items-center"><span class="font-bold">Asisten.</span> <input id="cfg-asi" class="input-base cfg-input" value="44.79" type="number" step="0.01" onchange="guardar()"></div>
            </div>
        </div>
    </details>

    <!-- SecciÃ³n 1: Perfil Fijo -->
    <div class="app-card">
        <div class="flex justify-center"><h3 class="section-badge">01. Perfil Fijo</h3></div>
        
        <p class="text-[11px] font-bold text-slate-400 uppercase tracking-wider mb-2 text-center">CategorÃ­a Profesional</p>
        <div class="segmented-control mb-6">
            <button onclick="setCat('B3')" id="btn-B3" class="btn-cat cat-activa">B3</button>
            <button onclick="setCat('B4')" id="btn-B4" class="btn-cat">B4</button>
            <button onclick="setCat('C5')" id="btn-C5" class="btn-cat">C5</button>
            <button onclick="setCat('C6')" id="btn-C6" class="btn-cat">C6</button>
        </div>

        <div class="flex justify-between items-center mb-4">
            <span class="font-bold text-slate-700 text-sm">AntigÃ¼edad (â‚¬)</span> 
            <input type="number" id="v-anti" class="input-base input-personal \!w-32" value="0.00" min="0" step="0.01">
        </div>
        <div class="flex justify-between items-center mb-6">
            <span class="font-bold text-slate-700 text-sm">Compl. Personal (â‚¬)</span> 
            <input type="number" id="v-comp" class="input-base input-personal \!w-32" value="0.00" min="0" step="0.01">
        </div>

        <div class="flex justify-between items-center bg-slate-50 p-4 rounded-xl border border-slate-100 mt-2">
            <div>
                <span class="block font-bold text-slate-800 text-sm">CÃ¡lculo por dÃ­as</span>
                <span class="block text-xs text-slate-500 mt-1">DÃ­as trabajados vs mes completo</span>
            </div>
            <label class="switch-ios">
                <input type="checkbox" id="check-inc" onchange="toggleInc()">
                <span class="slider"></span>
            </label>
        </div>
    </div>

    <!-- SecciÃ³n 2: Variables Mensuales -->
    <div class="app-card">
        <div class="flex justify-center"><h3 class="section-badge">02. Variables Mensuales</h3></div>

        <div id="bloque-inc" class="hidden mb-6 p-4 bg-red-50 border border-red-100 rounded-xl">
            <p class="font-bold text-xs text-red-600 uppercase tracking-wider mb-3 text-center">DÃ­as Trabajados en el mes</p>
            <div class="grid grid-cols-4 gap-2">
                <div class="flex flex-col items-center"><span class="font-bold text-xs mb-1 text-red-400">B3</span><input type="number" id="v-inc-B3" value="0" min="0" class="input-base input-var"></div>
                <div class="flex flex-col items-center"><span class="font-bold text-xs mb-1 text-red-400">B4</span><input type="number" id="v-inc-B4" value="0" min="0" class="input-base input-var"></div>
                <div class="flex flex-col items-center"><span class="font-bold text-xs mb-1 text-red-400">C5</span><input type="number" id="v-inc-C5" value="0" min="0" class="input-base input-var"></div>
                <div class="flex flex-col items-center"><span class="font-bold text-xs mb-1 text-red-400">C6</span><input type="number" id="v-inc-C6" value="0" min="0" class="input-base input-var"></div>
            </div>
        </div>

        <div id="bloque-dif" class="mb-6 inner-box">
            <p class="font-bold text-xs text-slate-500 uppercase tracking-wider mb-3 text-center">DÃ­as Diferencia Superior</p>
            <div class="grid grid-cols-3 gap-3">
                <div class="flex flex-col items-center"><span class="font-bold text-xs mb-1 text-slate-400">B4</span><input type="number" id="v-dif-B4" value="0" min="0" class="input-base input-var"></div>
                <div class="flex flex-col items-center"><span class="font-bold text-xs mb-1 text-slate-400">C5</span><input type="number" id="v-dif-C5" value="0" min="0" class="input-base input-var"></div>
                <div class="flex flex-col items-center"><span class="font-bold text-xs mb-1 text-slate-400">C6</span><input type="number" id="v-dif-C6" value="0" min="0" class="input-base input-var"></div>
            </div>
        </div>

        <div class="mb-6 inner-box">
            <p class="font-bold text-xs text-slate-500 uppercase tracking-wider mb-3 text-center">Noches Trabajadas</p>
            <div class="grid grid-cols-4 gap-2">
                <div class="flex flex-col items-center"><span class="font-bold text-xs mb-1 text-slate-400">B3</span><input type="number" id="v-noc-B3" value="0" min="0" class="input-base input-var"></div>
                <div class="flex flex-col items-center"><span class="font-bold text-xs mb-1 text-slate-400">B4</span><input type="number" id="v-noc-B4" value="0" min="0" class="input-base input-var"></div>
                <div class="flex flex-col items-center"><span class="font-bold text-xs mb-1 text-slate-400">C5</span><input type="number" id="v-noc-C5" value="0" min="0" class="input-base input-var"></div>
                <div class="flex flex-col items-center"><span class="font-bold text-xs mb-1 text-slate-400">C6</span><input type="number" id="v-noc-C6" value="0" min="0" class="input-base input-var"></div>
            </div>
        </div>

        <div class="mb-6 inner-box">
            <p class="font-bold text-xs text-slate-500 uppercase tracking-wider mb-3 text-center">Horas Extras Diurnas</p>
            <div class="grid grid-cols-4 gap-2">
                <div class="flex flex-col items-center"><span class="font-bold text-xs mb-1 text-slate-400">B3</span><input type="number" id="v-exD-B3" value="0" min="0" class="input-base input-var"></div>
                <div class="flex flex-col items-center"><span class="font-bold text-xs mb-1 text-slate-400">B4</span><input type="number" id="v-exD-B4" value="0" min="0" class="input-base input-var"></div>
                <div class="flex flex-col items-center"><span class="font-bold text-xs mb-1 text-slate-400">C5</span><input type="number" id="v-exD-C5" value="0" min="0" class="input-base input-var"></div>
                <div class="flex flex-col items-center"><span class="font-bold text-xs mb-1 text-slate-400">C6</span><input type="number" id="v-exD-C6" value="0" min="0" class="input-base input-var"></div>
            </div>
        </div>

        <div class="mb-6 inner-box">
            <p class="font-bold text-xs text-slate-500 uppercase tracking-wider mb-3 text-center">Horas Extras Nocturnas</p>
            <div class="grid grid-cols-4 gap-2">
                <div class="flex flex-col items-center"><span class="font-bold text-xs mb-1 text-slate-400">B3</span><input type="number" id="v-exN-B3" value="0" min="0" class="input-base input-var"></div>
                <div class="flex flex-col items-center"><span class="font-bold text-xs mb-1 text-slate-400">B4</span><input type="number" id="v-exN-B4" value="0" min="0" class="input-base input-var"></div>
                <div class="flex flex-col items-center"><span class="font-bold text-xs mb-1 text-slate-400">C5</span><input type="number" id="v-exN-C5" value="0" min="0" class="input-base input-var"></div>
                <div class="flex flex-col items-center"><span class="font-bold text-xs mb-1 text-slate-400">C6</span><input type="number" id="v-exN-C6" value="0" min="0" class="input-base input-var"></div>
            </div>
        </div>

        <div class="mb-6 inner-box">
            <p class="font-bold text-xs text-slate-500 uppercase tracking-wider mb-3 text-center">Horas Extras Festivas</p>
            <div class="grid grid-cols-4 gap-2">
                <div class="flex flex-col items-center"><span class="font-bold text-xs mb-1 text-slate-400">B3</span><input type="number" id="v-exF-B3" value="0" min="0" class="input-base input-var"></div>
                <div class="flex flex-col items-center"><span class="font-bold text-xs mb-1 text-slate-400">B4</span><input type="number" id="v-exF-B4" value="0" min="0" class="input-base input-var"></div>
                <div class="flex flex-col items-center"><span class="font-bold text-xs mb-1 text-slate-400">C5</span><input type="number" id="v-exF-C5" value="0" min="0" class="input-base input-var"></div>
                <div class="flex flex-col items-center"><span class="font-bold text-xs mb-1 text-slate-400">C6</span><input type="number" id="v-exF-C6" value="0" min="0" class="input-base input-var"></div>
            </div>
        </div>

        <div class="mb-6 inner-box">
            <p class="font-bold text-xs text-slate-500 uppercase tracking-wider mb-3 text-center">Horas Extras Festivas Nocturnas</p>
            <div class="grid grid-cols-4 gap-2">
                <div class="flex flex-col items-center"><span class="font-bold text-xs mb-1 text-slate-400">B3</span><input type="number" id="v-exFN-B3" value="0" min="0" class="input-base input-var"></div>
                <div class="flex flex-col items-center"><span class="font-bold text-xs mb-1 text-slate-400">B4</span><input type="number" id="v-exFN-B4" value="0" min="0" class="input-base input-var"></div>
                <div class="flex flex-col items-center"><span class="font-bold text-xs mb-1 text-slate-400">C5</span><input type="number" id="v-exFN-C5" value="0" min="0" class="input-base input-var"></div>
                <div class="flex flex-col items-center"><span class="font-bold text-xs mb-1 text-slate-400">C6</span><input type="number" id="v-exFN-C6" value="0" min="0" class="input-base input-var"></div>
            </div>
        </div>

        <div class="inner-box mb-6">
            <p class="font-bold text-xs text-slate-500 uppercase tracking-wider mb-3 text-center">4Âº Turno</p>
            <div class="grid grid-cols-4 gap-2">
                <div class="flex flex-col items-center"><span class="font-bold text-[10px] mb-1 text-slate-400">SAB 8h</span><input type="number" id="v-t-s8" value="0" min="0" class="input-base input-var"></div>
                <div class="flex flex-col items-center"><span class="font-bold text-[10px] mb-1 text-slate-400">SAB 12h</span><input type="number" id="v-t-s12" value="0" min="0" class="input-base input-var"></div>
                <div class="flex flex-col items-center"><span class="font-bold text-[10px] mb-1 text-slate-400">DOM 8h</span><input type="number" id="v-t-d8" value="0" min="0" class="input-base input-var"></div>
                <div class="flex flex-col items-center"><span class="font-bold text-[10px] mb-1 text-slate-400">DOM 12h</span><input type="number" id="v-t-d12" value="0" min="0" class="input-base input-var"></div>
            </div>
            <p class="text-[10px] font-bold text-red-500 mt-3 text-center uppercase tracking-wider">RECUERDA AÃ‘ADIR UNA NOCHE POR CADA CUARTO TURNO NOCTURNO</p>
        </div>

        <div class="inner-box mb-6">
            <p class="font-bold text-xs text-slate-500 uppercase tracking-wider mb-3 text-center">Arrancadores</p>
            <div class="grid grid-cols-3 gap-3">
                <div class="flex flex-col items-center"><span class="font-bold text-xs mb-1 text-slate-400">B4</span><input type="number" id="v-arr-B4" value="0" min="0" class="input-base input-var \!w-16 \!p-1\.5 \!text-sm"></div>
                <div class="flex flex-col items-center"><span class="font-bold text-xs mb-1 text-slate-400">C5</span><input type="number" id="v-arr-C5" value="0" min="0" class="input-base input-var \!w-16 \!p-1\.5 \!text-sm"></div>
                <div class="flex flex-col items-center"><span class="font-bold text-xs mb-1 text-slate-400">C6</span><input type="number" id="v-arr-C6" value="0" min="0" class="input-base input-var \!w-16 \!p-1\.5 \!text-sm"></div>
            </div>
        </div>

        <div class="inner-box mb-6">
            <div class="flex justify-between items-center">
                <span class="font-bold text-xs text-slate-700 uppercase tracking-wider">PromociÃ³n Vacaciones</span>
                <div class="flex items-center"><input type="number" id="v-prom-vac" value="0.00" min="0" step="0.01" class="input-base input-var \!w-24 \!p-1\.5 \!text-sm text-right"><span class="ml-2 font-bold text-slate-400">â‚¬</span></div>
            </div>
        </div>

        <div class="inner-box mb-2">
            <p class="font-bold text-xs text-slate-500 uppercase tracking-wider mb-4 text-center">Extras y Pluses Fijos</p>
            <div class="mb-3">
                <label class="btn-toggle">
                    <input type="checkbox" id="check-paga-extra">
                    <span><svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"></path></svg> Paga Extra Este Mes</span>
                </label>
            </div>
            <div class="grid grid-cols-2 gap-3 mb-5">
                <label class="btn-toggle">
                    <input type="checkbox" id="v-ads">
                    <span class="\!text-xs">AdscripciÃ³n FDS</span>
                </label>
                <label class="btn-toggle">
                    <input type="checkbox" id="v-asi">
                    <span class="\!text-xs">Plus Asistencia</span>
                </label>
            </div>
            
            <p class="font-bold text-[10px] text-blue-500 uppercase tracking-wider border-t border-slate-200 pt-4 mb-3 mt-2 text-center">Retribuciones Especiales (Opcional)</p>
            <div class="flex justify-between items-center mb-3">
                <span class="font-bold text-xs text-slate-700">1. Retrib. en Especie</span>
                <div class="flex items-center"><input type="number" id="cfg-especie" value="0.00" min="0" step="0.01" class="input-base input-var \!w-24 \!p-1\.5 \!text-sm text-right" onchange="guardar()"><span class="ml-2 font-bold text-slate-400">â‚¬</span></div>
            </div>
            <div class="flex justify-between items-center mb-3">
                <span class="font-bold text-xs text-slate-700">2. RDL 16/2013</span>
                <div class="flex items-center"><input type="number" id="cfg-rdl" value="0.00" min="0" step="0.01" class="input-base input-var \!w-24 \!p-1\.5 \!text-sm text-right" onchange="guardar()"><span class="ml-2 font-bold text-slate-400">â‚¬</span></div>
            </div>
            <div class="flex justify-between items-center">
                <span class="font-bold text-[11px] text-slate-700">3. Base Ingreso a Cta. IRPF</span>
                <div class="flex items-center"><input type="number" id="cfg-baseingreso" value="0.00" min="0" step="0.01" class="input-base input-var \!w-24 \!p-1\.5 \!text-sm text-right" onchange="guardar()"><span class="ml-2 font-bold text-slate-400">â‚¬</span></div>
            </div>
        </div>
    </div>

    <!-- SecciÃ³n 3: Deducciones -->
    <div class="app-card">
        <div class="flex justify-center"><h3 class="section-badge">03. Deducciones Reales</h3></div>
        <p class="text-center text-xs font-medium text-slate-500 mb-4">Ajusta los porcentajes para tu salario neto</p>
        
        <div class="inner-box flex-col gap-4">
            <div class="flex justify-between items-center">
                <span class="font-bold text-sm text-slate-700">IRPF</span>
                <div class="flex items-center"><input type="number" id="cfg-irpf" value="0.00" min="0" step="0.01" class="input-base input-var \!w-20 \!p-1\.5 \!text-sm text-right" onchange="guardar()"><span class="ml-2 font-bold text-slate-400">%</span></div>
            </div>
            <div class="flex justify-between items-center">
                <span class="font-bold text-sm text-slate-700">C. Comunes</span>
                <div class="flex items-center"><input type="number" id="cfg-cc" value="4.85" min="0" step="0.01" class="input-base input-var \!w-20 \!p-1\.5 \!text-sm text-right" onchange="guardar()"><span class="ml-2 font-bold text-slate-400">%</span></div>
            </div>
            <div class="flex justify-between items-center">
                <span class="font-bold text-sm text-slate-700">Desempleo</span>
                <div class="flex items-center"><input type="number" id="cfg-des" value="1.55" min="0" step="0.01" class="input-base input-var \!w-20 \!p-1\.5 \!text-sm text-right" onchange="guardar()"><span class="ml-2 font-bold text-slate-400">%</span></div>
            </div>
            <div class="flex justify-between items-center">
                <span class="font-bold text-sm text-slate-700">Form. Prof.</span>
                <div class="flex items-center"><input type="number" id="cfg-fp" value="0.10" min="0" step="0.01" class="input-base input-var \!w-20 \!p-1\.5 \!text-sm text-right" onchange="guardar()"><span class="ml-2 font-bold text-slate-400">%</span></div>
            </div>
            
            <div class="flex justify-between items-center pt-4 mt-2 border-t border-slate-200">
                <span class="font-bold text-sm text-red-600 flex items-center gap-1">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path></svg>
                    Seg. MÃ©dico (Flex)
                </span>
                <div class="flex items-center"><input type="number" id="cfg-segmed" value="0.00" min="0" step="0.01" class="input-base input-var \!w-24 \!p-1\.5 \!text-sm text-right text-red-600" onchange="guardar()"><span class="ml-2 font-bold text-slate-400">â‚¬</span></div>
            </div>
            <div class="flex justify-between items-center mt-3">
                <span class="font-bold text-sm text-red-600 flex items-center gap-1">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"></path></svg>
                    Acciones Coca Cola
                </span>
                <div class="flex items-center"><input type="number" id="cfg-acciones" value="0.00" min="0" step="0.01" class="input-base input-var \!w-24 \!p-1\.5 \!text-sm text-right text-red-600" onchange="guardar()"><span class="ml-2 font-bold text-slate-400">â‚¬</span></div>
            </div>
            <div class="flex justify-between items-center mt-3">
                <span class="font-bold text-sm text-red-600 flex items-center gap-1">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"></path></svg>
                    PrÃ©stamo Empresa
                </span>
                <div class="flex items-center"><input type="number" id="cfg-prestamo" value="0.00" min="0" step="0.01" class="input-base input-var \!w-24 \!p-1\.5 \!text-sm text-right text-red-600" onchange="guardar()"><span class="ml-2 font-bold text-slate-400">â‚¬</span></div>
            </div>
        </div>
    </div>

    <button onclick="calcular()" class="btn-calcular mt-6 mb-2">
        CALCULAR NÃ“MINA 
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3"></path></svg>
    </button>
    
    <div id="res-cont" class="hidden mt-8 mb-8">
        <div id="resultado"></div>
    </div>

    <a href="app-debug.apk" class="btn-download" download>
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
            <polyline points="7 10 12 15 17 10"></polyline>
            <line x1="12" y1="15" x2="12" y2="3"></line>
        </svg>
        Descargar App Android (.APK)
    </a>

    <div class="mt-10 mb-6 text-center">
        <p class="text-[10px] font-semibold leading-relaxed text-slate-400 px-6 uppercase tracking-wider">
            ðŸ”’ PRIVACIDAD TOTAL<br><br>
            Puedes instalarla en tu pantalla de inicio. Los datos que introduces se calculan y guardan exclusivamente en tu mÃ³vil.
        </p>
        <p class="text-[11px] font-bold text-slate-400 mt-8 tracking-wide border-t border-slate-200 mx-12 pt-4">
            Created by Francisco Irigoyen
        </p>
    </div>

</main>

<script>
    "use strict"; 

    // REGISTRO DE SERVICE WORKER PARA APP OFFLINE
    if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
            navigator.serviceWorker.register('sw.js').catch(() => {});
        });
    }

    window.catActiva = "B3";
    window.cats = ["B3", "B4", "C5", "C6"];
    window.inputsCfg = [
        'base-B3','base-B4','base-C5','base-C6', 
        'nivel-B3','nivel-B4','nivel-C5','nivel-C6', 
        'noc-B3','noc-B4','noc-C5','noc-C6', 
        'exD-B3','exD-B4','exD-C5','exD-C6', 
        'exN-B3','exN-B4','exN-C5','exN-C6', 
        'exF-B3','exF-B4','exF-C5','exF-C6', 
        'exFN-B3','exFN-B4','exFN-C5','exFN-C6',
        't-s8','t-s12','t-d8','t-d12', 
        'arr-B4', 'arr-C5','arr-C6', 
        'ads', 'asi', 'irpf', 'cc', 'des', 'fp', 'segmed', 'rdl', 'especie', 'baseingreso', 'acciones', 'prestamo'
    ];

    document.addEventListener('DOMContentLoaded', () => {
        document.querySelectorAll('input[type="number"]').forEach(input => {
            input.addEventListener('focus', function() {
                if (this.value === '0' || this.value === '0.00') {
                    this.dataset.oldValue = this.value; 
                    this.value = '';
                }
            });
            input.addEventListener('blur', function() {
                if (this.value === '') this.value = this.dataset.oldValue || '0';
                if (parseFloat(this.value) < 0) this.value = '0'; 
            });
        });
        window.cargar();
    });

    window.guardar = function() {
        try {
            if(typeof localStorage === 'undefined') return;
            let p = {};
            window.inputsCfg.forEach(id => {
                let el = document.getElementById('cfg-'+id);
                if(el) {
                    let val = parseFloat(el.value);
                    p[id] = (!isNaN(val) && val >= 0) ? val : 0;
                }
            });
            localStorage.setItem('cgt_pwa_precios', JSON.stringify(p));
        } catch(e) {}
    };

    window.cargar = function() {
        try {
            if(typeof localStorage === 'undefined') return;
            let saved = localStorage.getItem('cgt_pwa_precios');
            if (saved) {
                let p = JSON.parse(saved);
                window.inputsCfg.forEach(id => { 
                    if (p[id] !== undefined) {
                        let val = parseFloat(p[id]);
                        if(!isNaN(val) && val >= 0) {
                            let el = document.getElementById('cfg-'+id);
                            if(el) el.value = val;
                        }
                    }
                });
            }
        } catch(e) { localStorage.removeItem('cgt_pwa_precios'); }
    };

    window.setCat = function(c) {
        window.catActiva = c;
        document.querySelectorAll('.btn-cat').forEach(b => b.classList.remove('cat-activa'));
        document.getElementById('btn-'+c).classList.add('cat-activa');
    };

    window.toggleInc = function() {
        let isInc = document.getElementById('check-inc').checked;
        document.getElementById('bloque-inc').classList.toggle('hidden', !isInc);
        document.getElementById('bloque-dif').classList.toggle('hidden', isInc);
    };

    window.getP = function(id) { 
        let val = 0;
        let el = document.getElementById('cfg-'+id);
        
        // Si el elemento existe en el HTML (ej: IRPF, segmed, especie...), toma su valor
        if (el) {
            val = parseFloat(el.value);
        } 
        // Si no existe (ej: salarios base fijos), lo toma de la base de datos interna
        else if (window.preciosBaseFijos[id] !== undefined) {
            val = window.preciosBaseFijos[id];
        }

        return (!isNaN(val) && val >= 0) ? val : 0; 
    };

    window.getV = function(id) { 
        let el = document.getElementById(id);
        let val = el ? parseFloat(el.value) : 0;
        return (!isNaN(val) && val >= 0) ? val : 0; 
    };

    window.escapeHTML = function(str) {
        return String(str).replace(/[&<>'"]/g, match => ({ '&': '&amp;', '<': '&lt;', '>': '&gt;', "'": '&#39;', '"': '&quot;' }[match]));
    };

    window.calcular = function() {
        let brutoOrdinario = 0;
        let horasExtrasTotal = 0;
        let res = `
            <div class="text-center pb-4 mb-4 border-b border-slate-100">
                <h2 class="font-black text-xl text-slate-800 tracking-tight">Recibo de Salario</h2>
                <p class="text-xs font-bold text-slate-400 mt-1 uppercase tracking-widest">Detalle Estimado CGT</p>
            </div>`;
        
        let anti = window.getV('v-anti');
        let comp = window.getV('v-comp');
        let isInc = document.getElementById('check-inc').checked;

        res += `<div class="font-bold text-[10px] text-emerald-600 uppercase tracking-widest mb-3 bg-emerald-50 px-3 py-1.5 rounded-lg inline-block">Devengos (Ingresos)</div>`;

        if (isInc) {
            window.cats.forEach(c => {
                let d = window.getV('v-inc-'+c);
                if (d > 0) {
                    let catTotal = window.getP('base-'+c) + window.getP('nivel-'+c);
                    let m = ((catTotal + anti + comp) / 30) * d;
                    brutoOrdinario += m;
                    res += `<div class="flex justify-between text-sm mb-2"><span class="font-semibold text-slate-600">DÃ­as ${c} (${d}d):</span><span class="font-bold text-slate-900">${m.toFixed(2)}â‚¬</span></div>`;
                }
            });
        } else {
            let baseS = window.getP('base-'+window.catActiva);
            let nivelS = window.getP('nivel-'+window.catActiva);
            let baseTotal = baseS + nivelS;
            brutoOrdinario += baseTotal + anti + comp;
            res += `<div class="flex justify-between text-base mb-1"><span class="font-bold text-slate-800">Salario Base:</span><span class="font-bold text-slate-900">${baseS.toFixed(2)}â‚¬</span></div>`;
            res += `<div class="flex justify-between text-base mb-2 pb-2 border-b border-slate-100"><span class="font-bold text-slate-800">Complemento Nivel:</span><span class="font-bold text-slate-900">${nivelS.toFixed(2)}â‚¬</span></div>`;
            if (anti > 0) res += `<div class="flex justify-between text-slate-500 text-sm mb-1 font-medium"><span>AntigÃ¼edad:</span><span>+${anti.toFixed(2)}â‚¬</span></div>`;
            if (comp > 0) res += `<div class="flex justify-between text-slate-500 text-sm mb-1 font-medium"><span>Compl. Personal:</span><span>+${comp.toFixed(2)}â‚¬</span></div>`;

            ['B4', 'C5', 'C6'].forEach(c => {
                let d = window.getV('v-dif-'+c);
                if (d > 0) {
                    let catTotal = window.getP('base-'+c) + window.getP('nivel-'+c);
                    let m = ((catTotal - baseTotal) / 30) * d;
                    if (m > 0) { brutoOrdinario += m; res += `<div class="flex justify-between text-sm text-amber-600 mt-2 font-bold"><span>Dif. Superior ${window.escapeHTML(c)} (${d}d):</span><span>+${m.toFixed(2)}â‚¬</span></div>`; }
                }
            });
        }

        res += `<div class="my-3 border-t border-slate-100"></div>`;

        window.cats.forEach(c => {
            let dNoc = window.getV('v-noc-'+c);
            if (dNoc > 0) { let m = dNoc * window.getP('noc-'+c); brutoOrdinario += m; res += `<div class="flex justify-between text-blue-600 font-semibold text-sm mb-2"><span>Noches ${window.escapeHTML(c)} (${dNoc}):</span><span>+${m.toFixed(2)}â‚¬</span></div>`; }
            
            let hExD = window.getV('v-exD-'+c);
            if (hExD > 0) { let m = hExD * window.getP('exD-'+c); brutoOrdinario += m; horasExtrasTotal += m; res += `<div class="flex justify-between text-orange-500 font-semibold text-sm mb-2"><span>Extras Diurnas ${window.escapeHTML(c)} (${hExD}h):</span><span>+${m.toFixed(2)}â‚¬</span></div>`; }
            
            let hExN = window.getV('v-exN-'+c);
            if (hExN > 0) { let m = hExN * window.getP('exN-'+c); brutoOrdinario += m; horasExtrasTotal += m; res += `<div class="flex justify-between text-orange-500 font-semibold text-sm mb-2"><span>Extras Noct. ${window.escapeHTML(c)} (${hExN}h):</span><span>+${m.toFixed(2)}â‚¬</span></div>`; }

            let hExF = window.getV('v-exF-'+c);
            if (hExF > 0) { let m = hExF * window.getP('exF-'+c); brutoOrdinario += m; horasExtrasTotal += m; res += `<div class="flex justify-between text-orange-500 font-semibold text-sm mb-2"><span>Extras Festivas ${window.escapeHTML(c)} (${hExF}h):</span><span>+${m.toFixed(2)}â‚¬</span></div>`; }

            let hExFN = window.getV('v-exFN-'+c);
            if (hExFN > 0) { let m = hExFN * window.getP('exFN-'+c); brutoOrdinario += m; horasExtrasTotal += m; res += `<div class="flex justify-between text-orange-500 font-semibold text-sm mb-2"><span>Extras Fest. Noct. ${window.escapeHTML(c)} (${hExFN}h):</span><span>+${m.toFixed(2)}â‚¬</span></div>`; }
        });

        let tS8 = window.getV('v-t-s8'); if (tS8 > 0) { let m = tS8 * window.getP('t-s8'); brutoOrdinario += m; res += `<div class="flex justify-between text-indigo-500 font-semibold text-sm mb-2"><span>SÃ¡bados 8h (${tS8}):</span><span>+${m.toFixed(2)}â‚¬</span></div>`; }
        let tS12 = window.getV('v-t-s12'); if (tS12 > 0) { let m = tS12 * window.getP('t-s12'); brutoOrdinario += m; res += `<div class="flex justify-between text-indigo-500 font-semibold text-sm mb-2"><span>SÃ¡bados 12h (${tS12}):</span><span>+${m.toFixed(2)}â‚¬</span></div>`; }
        let tD8 = window.getV('v-t-d8'); if (tD8 > 0) { let m = tD8 * window.getP('t-d8'); brutoOrdinario += m; res += `<div class="flex justify-between text-indigo-500 font-semibold text-sm mb-2"><span>Domingos 8h (${tD8}):</span><span>+${m.toFixed(2)}â‚¬</span></div>`; }
        let tD12 = window.getV('v-t-d12'); if (tD12 > 0) { let m = tD12 * window.getP('t-d12'); brutoOrdinario += m; res += `<div class="flex justify-between text-indigo-500 font-semibold text-sm mb-2"><span>Domingos 12h (${tD12}):</span><span>+${m.toFixed(2)}â‚¬</span></div>`; }

        let aB4 = window.getV('v-arr-B4'); if (aB4 > 0) { let m = aB4 * window.getP('arr-B4'); brutoOrdinario += m; res += `<div class="flex justify-between text-purple-600 font-semibold text-sm mb-2"><span>Arrancador B4 (${aB4}):</span><span>+${m.toFixed(2)}â‚¬</span></div>`; }
        let aC5 = window.getV('v-arr-C5'); if (aC5 > 0) { let m = aC5 * window.getP('arr-C5'); brutoOrdinario += m; res += `<div class="flex justify-between text-purple-600 font-semibold text-sm mb-2"><span>Arrancador C5 (${aC5}):</span><span>+${m.toFixed(2)}â‚¬</span></div>`; }
        let aC6 = window.getV('v-arr-C6'); if (aC6 > 0) { let m = aC6 * window.getP('arr-C6'); brutoOrdinario += m; res += `<div class="flex justify-between text-purple-600 font-semibold text-sm mb-2"><span>Arrancador C6 (${aC6}):</span><span>+${m.toFixed(2)}â‚¬</span></div>`; }
        
        let chkAds = document.getElementById('v-ads');
        if (chkAds && chkAds.checked) { let m = window.getP('ads'); brutoOrdinario += m; res += `<div class="flex justify-between text-emerald-600 font-semibold text-sm mb-2"><span>AdscripciÃ³n FDS:</span><span>+${m.toFixed(2)}â‚¬</span></div>`; }
        
        let chkAsi = document.getElementById('v-asi');
        if (chkAsi && chkAsi.checked) { let m = window.getP('asi'); brutoOrdinario += m; res += `<div class="flex justify-between text-emerald-600 font-semibold text-sm mb-2"><span>Plus Asistencia:</span><span>+${m.toFixed(2)}â‚¬</span></div>`; }

        let promVac = window.getV('v-prom-vac');
        if (promVac > 0) { brutoOrdinario += promVac; res += `<div class="flex justify-between text-emerald-600 font-semibold text-sm mb-2"><span>PromociÃ³n Vacaciones:</span><span>+${promVac.toFixed(2)}â‚¬</span></div>`; }

        let especie = window.getP('especie');
        let rdl = window.getP('rdl');
        let baseIngresoCta = window.getP('baseingreso');
        let seguroMed = window.getP('segmed');

        let remuneracionTotal = brutoOrdinario + especie + rdl; 
        let hasExtraDevengo = (especie > 0 || rdl > 0);

        if (especie > 0) {
            res += `<div class="flex justify-between text-blue-600 font-bold text-sm mb-2 mt-3 pt-3 border-t border-slate-100"><span class="uppercase">RetribuciÃ³n en Especie:</span><span>+${especie.toFixed(2)}â‚¬</span></div>`;
        }
        if (rdl > 0) {
            res += `<div class="flex justify-between text-blue-600 font-bold text-sm mb-2 ${especie === 0 ? 'mt-3 pt-3 border-t border-slate-100' : ''}"><span class="uppercase">RDL 16/2013:</span><span>+${rdl.toFixed(2)}â‚¬</span></div>`;
        }

        if (seguroMed > 0) {
            res += `<div class="flex justify-between text-red-500 font-bold text-sm mb-2 ${!hasExtraDevengo ? 'mt-3 pt-3 border-t border-slate-100' : ''}"><span class="uppercase">Seguro MÃ©dico Flex:</span><span>-${seguroMed.toFixed(2)}â‚¬</span></div>`;
        }
        if (especie > 0) {
            res += `<div class="flex justify-between text-red-500 font-bold text-sm mb-2"><span class="uppercase">Comp. Retrib. Especie:</span><span>-${especie.toFixed(2)}â‚¬</span></div>`;
        }
        if (rdl > 0) {
            res += `<div class="flex justify-between text-red-500 font-bold text-sm mb-2"><span class="uppercase">Comp. RDL 16/2013:</span><span>-${rdl.toFixed(2)}â‚¬</span></div>`;
        }

        let totalDevengado = remuneracionTotal - seguroMed - especie - rdl;

        // FÃ“RMULA PAGA EXTRA: Salario Base + AntigÃ¼edad + Compl. Personal
        let basePagaExtra = window.getP('base-'+window.catActiva); 
        let importeUnaPagaExtra = basePagaExtra + anti + comp;
        let prorrataMensual = (importeUnaPagaExtra * 4) / 12;

        if (isInc) {
            let totalDias = 0;
            window.cats.forEach(c => totalDias += window.getV('v-inc-'+c));
            prorrataMensual = (prorrataMensual / 30) * totalDias;
        }

        let cobroExtra = document.getElementById('check-paga-extra').checked;
        let pagaExtraCobrada = cobroExtra ? importeUnaPagaExtra : 0;
        
        let totalDevengadoConExtra = totalDevengado + pagaExtraCobrada;

        if (cobroExtra) {
            res += `<div class="flex justify-between text-emerald-600 font-black text-sm mt-4 pt-3 border-t border-slate-100 uppercase"><span>ðŸ’³ Paga Extraordinaria:</span><span>+${importeUnaPagaExtra.toFixed(2)}â‚¬</span></div>`;
        }

        res += `<div class="mt-4 pt-4 flex justify-between text-base font-black text-slate-800 border-t-2 border-slate-200 uppercase tracking-wide"><span>Total Devengado (Bruto):</span><span class="text-slate-900">${totalDevengadoConExtra.toFixed(2)}â‚¬</span></div>`;

        let pIrpf = window.getP('irpf');
        let pCc = window.getP('cc');
        let pDes = window.getP('des');
        let pFp = window.getP('fp');
        let totalDeduccionesPct = pIrpf + pCc + pDes + pFp;
        
        let dAcciones = window.getP('acciones');
        let dPrestamo = window.getP('prestamo');

        if (totalDeduccionesPct > 0 || dAcciones > 0 || dPrestamo > 0) {
            
            let baseCC = (remuneracionTotal - horasExtrasTotal) + prorrataMensual;
            let baseCP = remuneracionTotal + prorrataMensual; 

            // CÃLCULO BASE MÃXIMA Y CUOTA DE SOLIDARIDAD (2026)
            let baseMax = 5101.20;
            let baseCP_sin_tope = baseCP;
            let baseCC_sin_tope = baseCC;
            let dSolidaridad = 0;

            if (baseCP_sin_tope > baseMax) {
                let limite1 = 5611.32;
                let limite2 = 7651.80;
                let tramo1 = 0, tramo2 = 0, tramo3 = 0;

                if (baseCP_sin_tope <= limite1) {
                    tramo1 = baseCP_sin_tope - baseMax;
                } else if (baseCP_sin_tope <= limite2) {
                    tramo1 = limite1 - baseMax;
                    tramo2 = baseCP_sin_tope - limite1;
                } else {
                    tramo1 = limite1 - baseMax;
                    tramo2 = limite2 - limite1;
                    tramo3 = baseCP_sin_tope - limite2;
                }
                dSolidaridad = (tramo1 * 0.0019) + (tramo2 * 0.0021) + (tramo3 * 0.0024);
            }

            if (baseCC > baseMax) baseCC = baseMax;
            if (baseCP > baseMax) baseCP = baseMax;

            let dIrpf = totalDevengadoConExtra * (pIrpf / 100); 
            let dIngresoCta = baseIngresoCta * (pIrpf / 100);

            let dCc = baseCC * (pCc / 100);
            let dDes = baseCP * (pDes / 100);
            let dFp = baseCP * (pFp / 100);
            
            let totalDeducido = dIrpf + dIngresoCta + dCc + dDes + dFp + dSolidaridad + dAcciones + dPrestamo;
            let neto = totalDevengadoConExtra - totalDeducido;

            res += `<div class="mt-6 pt-5 border-t border-slate-200">`;
            res += `<div class="font-bold text-[10px] text-slate-500 uppercase tracking-widest mb-3 bg-slate-100 px-3 py-1.5 rounded-lg inline-block">Bases de CotizaciÃ³n S.S.</div>`;
            res += `<div class="flex justify-between text-slate-500 font-medium text-xs mb-1"><span>Prorrata P. Extras (4):</span><span>${prorrataMensual.toFixed(2)}â‚¬</span></div>`;
            res += `<div class="flex justify-between text-slate-500 font-medium text-xs mb-1"><span>Base Cont. Comunes${baseCC_sin_tope > baseMax ? ' (Topada)' : ''}:</span><span>${baseCC.toFixed(2)}â‚¬</span></div>`;
            res += `<div class="flex justify-between text-slate-500 font-medium text-xs mb-4"><span>Base Cont. Profesionales${baseCP_sin_tope > baseMax ? ' (Topada)' : ''}:</span><span>${baseCP.toFixed(2)}â‚¬</span></div>`;
            
            res += `<div class="font-bold text-[10px] text-red-500 uppercase tracking-widest mb-3 bg-red-50 px-3 py-1.5 rounded-lg inline-block mt-2">Deducciones Trabajador</div>`;
            
            if (pIrpf > 0) res += `<div class="flex justify-between text-red-500 font-semibold text-xs mb-2"><span>RetenciÃ³n IRPF (${pIrpf}%):</span><span>-${dIrpf.toFixed(2)}â‚¬</span></div>`;
            if (dIngresoCta > 0 && pIrpf > 0) res += `<div class="flex justify-between text-red-500 font-semibold text-xs mb-2"><span>Ingreso a Cta. IRPF:</span><span>-${dIngresoCta.toFixed(2)}â‚¬</span></div>`;

            if (pCc > 0) res += `<div class="flex justify-between text-red-500 font-semibold text-xs mb-2"><span>C. Comunes (${pCc}% s/ ${baseCC.toFixed(2)}):</span><span>-${dCc.toFixed(2)}â‚¬</span></div>`;
            if (pDes > 0) res += `<div class="flex justify-between text-red-500 font-semibold text-xs mb-2"><span>Desempleo (${pDes}% s/ ${baseCP.toFixed(2)}):</span><span>-${dDes.toFixed(2)}â‚¬</span></div>`;
            if (pFp > 0) res += `<div class="flex justify-between text-red-500 font-semibold text-xs mb-2"><span>Form. Prof. (${pFp}% s/ ${baseCP.toFixed(2)}):</span><span>-${dFp.toFixed(2)}â‚¬</span></div>`;
            if (dSolidaridad > 0) res += `<div class="flex justify-between text-red-500 font-semibold text-xs mb-2"><span>Cuota Solidaridad (> 5101.20â‚¬):</span><span>-${dSolidaridad.toFixed(2)}â‚¬</span></div>`;
            if (dAcciones > 0) res += `<div class="flex justify-between text-red-500 font-semibold text-xs mb-2"><span>Acciones Coca Cola:</span><span>-${dAcciones.toFixed(2)}â‚¬</span></div>`;
            if (dPrestamo > 0) res += `<div class="flex justify-between text-red-500 font-semibold text-xs mb-2"><span>PrÃ©stamo Empresa:</span><span>-${dPrestamo.toFixed(2)}â‚¬</span></div>`;
            
            res += `<div class="flex justify-between text-red-600 font-bold text-sm mt-3 pt-3 border-t border-red-100"><span>Total Deducido:</span><span>-${totalDeducido.toFixed(2)}â‚¬</span></div>`;
            res += `</div>`;
            
            res += `<div class="mt-6 pt-6 flex flex-col justify-center items-center bg-emerald-50 rounded-2xl p-6 border border-emerald-100 shadow-inner">
                        <span class="text-emerald-800 font-bold text-sm tracking-widest uppercase mb-1">Total a Percibir</span>
                        <span class="text-4xl font-black text-emerald-600 tracking-tight">${neto.toFixed(2)}â‚¬</span>
                    </div>`;
        }
        
        let contenedor = document.getElementById('resultado');
        if(contenedor) {
            contenedor.innerHTML = res;
            document.getElementById('res-cont').classList.remove('hidden');
            
            // AnimaciÃ³n
            document.getElementById('res-cont').style.opacity = 0;
            document.getElementById('res-cont').style.transform = 'translateY(20px)';
            document.getElementById('res-cont').style.transition = 'all 0.5s ease-out';
            
            setTimeout(() => { 
                document.getElementById('res-cont').style.opacity = 1;
                document.getElementById('res-cont').style.transform = 'translateY(0)';
                window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' }); 
            }, 50); 
        }
    };
</script>

</body>
</html>